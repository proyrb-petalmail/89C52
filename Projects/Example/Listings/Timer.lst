C51 COMPILER V9.60.7.0   TIMER                                                             01/02/2024 09:12:21 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\Objects\Timer.obj
COMPILER INVOKED BY: C:\Program Files\Keil_v5\C51\BIN\C51.EXE Timer\Timer.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND 
                    -PRINT(.\Listings\Timer.lst) TABS(3) OBJECT(.\Objects\Timer.obj)

line level    source

   1          #include "Timer.h"
   2          
   3          static unsigned char timer0_h, timer0_l; //å®šæ—¶å™¨0çš„è®¡æ•°å™¨çš„åˆå§‹å€¼
   4          static unsigned char timer1_h, timer1_l; //å®šæ—¶å™¨1çš„è®¡æ•°å™¨çš„åˆå§‹å€¼
   5          
   6          static void (* timer0_callback)(void); //å®šæ—¶å™¨0ä¸­æ–­æ—¶çš„å›è°ƒå‡½æ•°
   7          static void (* timer1_callback)(void); //å®šæ—¶å™¨1ä¸­æ–­æ—¶çš„å›è°ƒå‡½æ•°
   8          
   9          void Timer_Initial(const bit timer, const unsigned char high, const unsigned char low) {
  10   1         switch((unsigned char)timer) {
  11   2            case 0:
  12   2               TH0 = timer0_h = high;TL0 = timer0_l = low; //è®°å½•å®šæ—¶å™¨0è®¡æ•°å™¨çš„åˆå§‹å€¼
  13   2               TMOD = (TMOD & 0xF0) | 0x01; //è®¾ç½®å®šæ—¶å™¨0çš„å·¥ä½œæ¨¡å¼
  14   2               ET0 = 1; //æ‰“å¼€å®šæ—¶å™¨0çš„ä¸­æ–­
  15   2               break;
  16   2            case 1:
  17   2               TH1 = timer1_h = high;TL1 = timer1_l = low; //è®°å½•å®šæ—¶å™¨1è®¡æ•°å™¨çš„åˆå§‹å€¼
  18   2               TMOD = (TMOD & 0x0F) | 0x10; //è®¾ç½®å®šæ—¶å™¨1çš„å·¥ä½œæ¨¡å¼
  19   2               ET1 = 1; //æ‰“å¼€å®šæ—¶å™¨1çš„ä¸­æ–­
  20   2               break;
  21   2         }
  22   1         EA = 1; //æ‰“å¼€æ€»ä¸­æ–­
  23   1      }
  24          
  25          void Timer_Control(const bit timer, const bit control) {
  26   1         (timer == 0) ? (TR0 = (control == 0 ? 0 : 1)) : (TR1 = (control == 0 ? 0 : 1)); //å¯åŠ¨æˆ–åœæ­¢æŒ‡å®š
             -å®šæ—¶å™¨çš„è®¡æ•°å™¨
  27   1      }
  28          
  29          void Timer_Callback(const bit timer, void * const callback) {
  30   1         (timer == 0) ? (timer0_callback = callback) : (timer1_callback = callback); //ä¸ºæŒ‡å®šå®šæ—¶å™¨é…ç½®ä
             -¸­æ–­æ—¶çš„å›è°ƒå‡½æ•°
  31   1      }
  32          
  33          void Timer0_Interrupt(void) interrupt 1 {
  34   1         TH0 = timer0_h;TL0 = timer0_l; //å°†å®šæ—¶å™¨0çš„è®¡æ•°å™¨æ¢å¤ä¸ºåˆå§‹å€¼
  35   1         if(timer0_callback) timer0_callback(); //å¦‚æœå®šæ—¶å™¨0ä¸­æ–­æ—¶çš„å›è°ƒå‡½æ•°å­˜åœ¨åˆ™æ‰§è¡Œ
  36   1      }
  37          
  38          void Timer1_Interrupt(void) interrupt 3 {
  39   1         TH1 = timer1_h;TL1 = timer1_l; //å°†å®šæ—¶å™¨1çš„è®¡æ•°å™¨æ¢å¤ä¸ºåˆå§‹å€¼
  40   1         if(timer1_callback) timer1_callback(); //å¦‚æœå®šæ—¶å™¨1ä¸­æ–­æ—¶çš„å›è°ƒå‡½æ•°å­˜åœ¨åˆ™æ‰§è¡Œ
  41   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    259    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     10       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       4
END OF MODULE INFORMATION.

C51 COMPILER V9.60.7.0   TIMER                                                             01/02/2024 09:12:21 PAGE 2   


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
